<!-- items.html -->
<html>

<head>
  <title>Auction Items</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <script src="//code.jquery.com/jquery.min.js"></script>

  <style>
    .itemHeader {
      background-color: black;
      color: white;
    }

    .table-item {
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <div id="nav-placeholder">

  </div>

  <h1>Auction Items</h1>
  <div id="itemsList" class="container"></div>

  <script>
   $(function () {
      $("#nav-placeholder").load("../nav.html");
    });


    const pathArray = window.location.pathname.split('/');
    const session_ID = pathArray[pathArray.length - 1];

    console.log(session_ID);
    console.log(session_ID);
    // Fetch items data from the server
    fetch(`/auth/item_by_session/${session_ID}`, {
      method: 'GET',
    })
      .then(response => response.json())
      .then(responseData => {
        let d=''
        // Ensure that items is an array
        d += '<table> <thead class="itemHeader"><tr>     <th>Image</th> <th>Name</th>  <th>Start_time</th> <th>End_time</th> <th>Action</th> </tr> </thead><tbody>'
        // Update HTML with items data
        $.each(responseData['items'],function(e, v){   
          d += '<tr class="table-item"> <td>' + '<a id ="' + v['ID'] + '" href="/bid_item/' + v['ID'] + '">' + '<img class="img-fluid" style="width:200px; height:80px;" src="' + v['picture'] + '">' + '</a></td>'
          d += ' <td>' + '<a id ="' + v['ID'] + '" href="/bid_item/' + v['ID'] + '"><p>' + v['Item_name'] + '</p></a></td>'
          d += ' <td>' + '<a id ="' + v['ID'] + '" href="/bid_item/' + v['ID'] + '"><p>' + v['Start_time'] + '</p></a></td>'
          d += ' <td>' + '<a id ="' + v['ID'] + '" href="/bid_item/' + v['ID'] + '"><p>' + v['End_time'] + '</p></a></td>'
          d += '</tr>'

        });
        d += '</tbody></table>'
        document.getElementById('itemsList').innerHTML += d;
      })
      .catch(error => console.error('Error fetching items:', error));
  </script>

</body>

</html>